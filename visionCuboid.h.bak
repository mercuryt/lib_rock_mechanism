/*
 * A cuboid of space where every block has line of sight to every other block.
 * Used to skip line of sight calculations.
 * Stored in Area::m_visionCuboids. Deleted durring Area::writeStep if m_destroy is true.
 */
#pragma once
#include <cstdint>
#include "cuboid.h"
class BLOCK;
class Area;
class VisionCuboid
{
public:
	static void setup(Area& area);
	static void clearDestroyed(Area& area);
	static void BlockIsNeverOpaque(BLOCK& block);
	static void BlockIsSometimesOpaque(BLOCK& block);
	static void BlockFloorIsNeverOpaque(BLOCK& block);
	static void BlockFloorIsSometimesOpaque(BLOCK& block);
	static VisionCuboid* getTargetToCombineWith(const Cuboid& cuboid);

	Cuboid m_cuboid;
	bool m_destroy;

	VisionCuboid(Cuboid& cuboid);
	bool canSeeInto(const Cuboid& cuboid) const;
	bool canCombineWith(const Cuboid& cuboid) const;
	void splitAt(BLOCK& split);
	void splitBelow(BLOCK& split);
	void extend(Cuboid& cuboid);
};
